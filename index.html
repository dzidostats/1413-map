<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>State of Survival â€“ Interaktywna Mapa</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
  body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    width: 100%;
    background: #111;
  }
  #map {
    height: 100vh;
    width: 100vw;
  }
  .marker-gold {
    background-color: gold;
    border-radius: 50%;
    width: 14px;
    height: 14px;
    border: 2px solid #b8860b;
  }
  .marker-purple {
    background-color: purple;
    border-radius: 50%;
    width: 14px;
    height: 14px;
    border: 2px solid #4b0082;
  }
</style>
</head>
<body>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  const map = L.map('map', {
    minZoom: -2,
    maxZoom: 4,
    crs: L.CRS.Simple
  });

  const w = 1300;
  const h = 1300;
  const url = 'wilderness_map_original.png';

  const bounds = [[0,0], [h, w]];
  const image = L.imageOverlay(url, bounds).addTo(map);

  map.fitBounds(bounds);

  // ðŸ”¥ ObrÃ³t ukÅ‚adu wspÃ³Å‚rzÄ™dnych o 45Â°
  map.whenReady(() => {
    const size = map.getSize();
    const cx = size.x / 2;
    const cy = size.y / 2;

    const panes = [
      map.getPanes().markerPane,
      map.getPanes().shadowPane,
      map.getPanes().popupPane
    ];

    panes.forEach(p => {
      p.style.transformOrigin = `${cx}px ${cy}px`;
      p.style.transform = `rotate(45deg)`;
    });

    // Dodatkowo - aktualizuj punkt obrotu przy zmianie rozmiaru mapy
    map.on('resize', () => {
      const newSize = map.getSize();
      const ncx = newSize.x / 2;
      const ncy = newSize.y / 2;

      panes.forEach(p => {
        p.style.transformOrigin = `${ncx}px ${ncy}px`;
      });
    });
  });

  function createIcon(className) {
    return L.divIcon({
      className: className,
      iconSize: [16,16]
    });
  }

  const points = [
    { coords: [650, 650], name: 'Capital', type: 'gold' },
    { coords: [488, 648], name: 'ff1', type: 'gold' },
    { coords: [648, 488], name: 'ff2', type: 'gold' },
    { coords: [808, 648], name: 'ff3', type: 'gold' },
    { coords: [648, 808], name: 'ff4', type: 'gold' },
    { coords: [258, 898], name: 'b1', type: 'purple' },
    { coords: [258, 638], name: 'b2', type: 'purple' },
    { coords: [258, 378], name: 'b3', type: 'purple' },
    { coords: [398, 258], name: 'b4', type: 'purple' },
    { coords: [658, 258], name: 'b5', type: 'purple' },
    { coords: [918, 258], name: 'b6', type: 'purple' },
    { coords: [1038, 378], name: 'b7', type: 'purple' },
    { coords: [1038, 638], name: 'b8', type: 'purple' },
    { coords: [1038, 898], name: 'b9', type: 'purple' },
    { coords: [918, 1038], name: 'b10', type: 'purple' },
    { coords: [658, 1038], name: 'b11', type: 'purple' },
    { coords: [398, 1038], name: 'b12', type: 'purple' }
  ];

  points.forEach(p => {
    const icon = p.type === 'gold'
      ? createIcon('marker-gold')
      : createIcon('marker-purple');

    L.marker(p.coords, { icon }).addTo(map).bindPopup(p.name);
  });
</script>
</body>
</html>
